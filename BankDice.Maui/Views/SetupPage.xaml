<?xml version="1.0" encoding="utf-8" ?>
<ContentPage
    x:Class="BankDice.Maui.Views.SetupPage"
    xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
    xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
    Title="Setup">

    <VerticalStackLayout Padding="16" Spacing="12">

        <Label Text="Players (3 - 8)" FontAttributes="Bold" />

        <HorizontalStackLayout Spacing="8" HorizontalOptions="Center">
            <Entry Text="{Binding NewName}" Placeholder="Player name" WidthRequest="250"/>
            <Button Text="Add" Command="{Binding AddPlayerCommand}" WidthRequest="100" />
        </HorizontalStackLayout>

        <Button Text="{Binding OrderButtonText}" Command="{Binding ToggleOrderingCommand}" WidthRequest="250" HorizontalOptions="Center" />

        <CollectionView ItemsSource="{Binding Players}">
            <CollectionView.ItemTemplate>
                <DataTemplate>
                    <Grid Padding="6" ColumnSpacing="8">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>

                        <Label Grid.Column="0" Text="{Binding Order}" FontAttributes="Bold" VerticalTextAlignment="Center"/>
                        <Label Grid.Column="1" Text="{Binding Name}" VerticalTextAlignment="Center"/>

                        <Button Grid.Column="2" Text="↑"
                                Command="{Binding Source={RelativeSource AncestorType={x:Type ContentPage}}, Path=BindingContext.MoveUpCommand}"
                                CommandParameter="{Binding .}"
                                IsVisible="{Binding Source={RelativeSource AncestorType={x:Type ContentPage}}, Path=BindingContext.IsOrderingMode}"
                                WidthRequest="40" />

                        <Button Grid.Column="3" Text="↓"
                                Command="{Binding Source={RelativeSource AncestorType={x:Type ContentPage}}, Path=BindingContext.MoveDownCommand}"
                                CommandParameter="{Binding .}"
                                IsVisible="{Binding Source={RelativeSource AncestorType={x:Type ContentPage}}, Path=BindingContext.IsOrderingMode}"
                                WidthRequest="40" />

                        <Button Grid.Column="4" Text="Remove"
                                Command="{Binding Source={RelativeSource AncestorType={x:Type ContentPage}}, Path=BindingContext.RemovePlayerCommand}"
                                CommandParameter="{Binding .}"
                                WidthRequest="90" />
                    </Grid>
                </DataTemplate>
            </CollectionView.ItemTemplate>
        </CollectionView>

        <Label Text="Rounds (7–30)" FontAttributes="Bold"/>
        <Entry Text="{Binding Rounds}" Keyboard="Numeric" />

        <Label Text="{Binding ValidationMessage}" TextColor="Red" />

        <Button Text="Start Game"
                Command="{Binding StartGameCommand}"
                IsEnabled="{Binding CanStart}"
                WidthRequest="250"
                HorizontalOptions="Center" />
    </VerticalStackLayout>
</ContentPage>
